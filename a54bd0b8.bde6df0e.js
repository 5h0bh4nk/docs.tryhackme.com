(window.webpackJsonp=window.webpackJsonp||[]).push([[21],{81:function(e,t,n){"use strict";n.r(t),n.d(t,"frontMatter",(function(){return a})),n.d(t,"metadata",(function(){return s})),n.d(t,"rightToc",(function(){return c})),n.d(t,"default",(function(){return p}));var o=n(2),r=n(6),i=(n(0),n(99)),a={id:"openvpn-troubleshooting",title:"OpenVPN Troubleshooting",sidebar_label:"OpenVPN Troubleshooting"},s={unversionedId:"openvpn/troubleshooting/openvpn-troubleshooting",id:"openvpn/troubleshooting/openvpn-troubleshooting",isDocsHomePage:!1,title:"OpenVPN Troubleshooting",description:"Using the THM troubleshooting Script:",source:"@site/docs/openvpn/troubleshooting/troubleshooting.md",slug:"/openvpn/troubleshooting/openvpn-troubleshooting",permalink:"/docs/openvpn/troubleshooting/openvpn-troubleshooting",editUrl:"https://github.com/tryhackmeltd/docs.tryhackme.com/edit/master/docs/openvpn/troubleshooting/troubleshooting.md",version:"current",lastUpdatedBy:"Tony Kolstee",lastUpdatedAt:1619655495,sidebar_label:"OpenVPN Troubleshooting",sidebar:"docs",previous:{title:"Connecting With OpenVPN",permalink:"/docs/openvpn/connecting/openvpn-connecting"},next:{title:"What are Rooms",permalink:"/docs/rooms/what-are-rooms"}},c=[{value:"Using the THM troubleshooting Script:",id:"using-the-thm-troubleshooting-script",children:[]},{value:"Other Considerations:",id:"other-considerations",children:[]},{value:"Not receiving reverse shells or Metasploit not creating Sessions?",id:"not-receiving-reverse-shells-or-metasploit-not-creating-sessions",children:[]},{value:"Intermittent connection (random drop-outs):",id:"intermittent-connection-random-drop-outs",children:[]},{value:"External access not working:",id:"external-access-not-working",children:[{value:"Checking for external Issues:",id:"checking-for-external-issues",children:[]}]}],l={rightToc:c};function p(e){var t=e.components,n=Object(r.a)(e,["components"]);return Object(i.b)("wrapper",Object(o.a)({},l,n,{components:t,mdxType:"MDXLayout"}),Object(i.b)("h2",{id:"using-the-thm-troubleshooting-script"},"Using the THM troubleshooting Script:"),Object(i.b)("p",null,Object(i.b)("a",Object(o.a)({parentName:"p"},{href:"https://tryhackme.com/p/MuirlandOracle"}),Object(i.b)("strong",{parentName:"a"},"MuirlandOracle"))," has created a handy troubleshooting script for Linux that automates a large portion of the troubleshooting process for you. You can download it from ",Object(i.b)("a",Object(o.a)({parentName:"p"},{href:"https://github.com/tryhackme/openvpn-troubleshooting"}),Object(i.b)("strong",{parentName:"a"},"TryHackMe's Github")),"."),Object(i.b)("h2",{id:"other-considerations"},"Other Considerations:"),Object(i.b)("p",null,"As it stands, TryHackMe only supports OpenVPN via UDP. If you are in a country such as Egypt or China where a VPN over UDP is blocked, until TCP is supported, the alternative is to ",Object(i.b)("a",Object(o.a)({parentName:"p"},{href:"https://tryhackme.com/my-machine"}),Object(i.b)("strong",{parentName:"a"},"deploy your own Kali instance"))," in the cloud. This instance is hosted on TryHackMe and is publicly accessible without a VPN connection. "),Object(i.b)("p",null,"If you see messages relating to TLS errors, go to ",Object(i.b)("a",Object(o.a)({parentName:"p"},{href:"https://openvpn.net/faq/tls-error-tls-key-negotiation-failed-to-occur-within-60-seconds-check-your-network-connectivity/"}),Object(i.b)("strong",{parentName:"a"},"this OpenVPN article")),"."),Object(i.b)("h2",{id:"not-receiving-reverse-shells-or-metasploit-not-creating-sessions"},"Not receiving reverse shells or Metasploit not creating Sessions?"),Object(i.b)("p",null,"This is most commonly due to incorrect exploit settings within Metasploit / exploit code. This should be the first thing to check. Ensure that you are using your THM IP address as your ",Object(i.b)("inlineCode",{parentName:"p"},"lhost")," option and the IP address of the instance assigned to you as your ",Object(i.b)("inlineCode",{parentName:"p"},"rhosts"),"."),Object(i.b)("p",null,"Another possibility is people connecting via the OpenVPN on their host machine and not through their virtual machine. For example, running Kali Linux in Virtualbox on your Windows 10 PC. Ensure you are connecting via one session on Kali, rather than your Windows 10 PC."),Object(i.b)("h2",{id:"intermittent-connection-random-drop-outs"},"Intermittent connection (random drop-outs):"),Object(i.b)("p",null,"This issue usually stems from client-side issues that can be checked using the ",Object(i.b)("a",Object(o.a)({parentName:"p"},{href:"https://github.com/tryhackme/openvpn-troubleshooting"}),Object(i.b)("strong",{parentName:"a"},"troubleshooting script")),". However, look for external factors to OpenVPN as to why you are experiencing issues if this script does not help."),Object(i.b)("h2",{id:"external-access-not-working"},"External access not working:"),Object(i.b)("p",null,"When importing the OpenVPN configuration file into the Kali Linux GUI, kali will route all internet traffic through the VPN by default. In this case you won't be able to contact external sites (e.g. 'apt update' doesn't work), but you can connect to resources on the THM network. Run the following to address the problem:"),Object(i.b)("pre",null,Object(i.b)("code",Object(o.a)({parentName:"pre"},{className:"language-sh"}),"  $ nmcli connection   # Note the name of the VPN connection here\n  $ nmcli connection edit (connection_name)\n  > set ipv4.never-default true\n  > set ipv6.never-default true\n  > save\n  > quit\n")),Object(i.b)("p",null,Object(i.b)("a",Object(o.a)({parentName:"p"},{href:"https://blog.djsdev.com/2020/03/add-htb-vpn-to-kali-20201-and-fix-vpn.html"}),"Credit: Caleb Stewart")),Object(i.b)("h3",{id:"checking-for-external-issues"},"Checking for external Issues:"),Object(i.b)("ol",null,Object(i.b)("li",{parentName:"ol"},"In this setup, OpenVPN does not route all of your internet traffic through TryHackMe - are you able to connect to external websites like google? If not, this is an issue with your internet service"),Object(i.b)("li",{parentName:"ol"},"Are you using WiFi? Perhaps there could be interference or distancing issues resulting in a weak signal that would disrupt connectivity."),Object(i.b)("li",{parentName:"ol"},"Are you in a country that blocks OpenVPN traffic? (China, Egypt)")),Object(i.b)("p",null,"Finally, if you are confident that your internet connection is stable, try switching VPN servers via the ",Object(i.b)("a",Object(o.a)({parentName:"p"},{href:"https://tryhackme.com/access"}),Object(i.b)("strong",{parentName:"a"},"access page")),"."))}p.isMDXComponent=!0},99:function(e,t,n){"use strict";n.d(t,"a",(function(){return u})),n.d(t,"b",(function(){return d}));var o=n(0),r=n.n(o);function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function s(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach((function(t){i(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function c(e,t){if(null==e)return{};var n,o,r=function(e,t){if(null==e)return{};var n,o,r={},i=Object.keys(e);for(o=0;o<i.length;o++)n=i[o],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(o=0;o<i.length;o++)n=i[o],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var l=r.a.createContext({}),p=function(e){var t=r.a.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):s(s({},t),e)),n},u=function(e){var t=p(e.components);return r.a.createElement(l.Provider,{value:t},e.children)},h={inlineCode:"code",wrapper:function(e){var t=e.children;return r.a.createElement(r.a.Fragment,{},t)}},b=r.a.forwardRef((function(e,t){var n=e.components,o=e.mdxType,i=e.originalType,a=e.parentName,l=c(e,["components","mdxType","originalType","parentName"]),u=p(n),b=o,d=u["".concat(a,".").concat(b)]||u[b]||h[b]||i;return n?r.a.createElement(d,s(s({ref:t},l),{},{components:n})):r.a.createElement(d,s({ref:t},l))}));function d(e,t){var n=arguments,o=t&&t.mdxType;if("string"==typeof e||o){var i=n.length,a=new Array(i);a[0]=b;var s={};for(var c in t)hasOwnProperty.call(t,c)&&(s[c]=t[c]);s.originalType=e,s.mdxType="string"==typeof e?e:o,a[1]=s;for(var l=2;l<i;l++)a[l]=n[l];return r.a.createElement.apply(null,a)}return r.a.createElement.apply(null,n)}b.displayName="MDXCreateElement"}}]);